<div class="app-container">
  <div class="header">
    <h1
      class="title-todo"
      [ngClass]="showDone ? 'title-todo-hidden' : showDone !== null ? 'title-todo-shown' : ''"
    >
      TO-DO
    </h1>
    <h1
      class="title-done"
      [ngClass]="showDone === null ? 'hidden' : showDone ? 'title-done-shown' : 'title-done-hidden'"
    >
      DONE
    </h1>
    <mat-slide-toggle (change)="handleToggleChange($event)" />
  </div>

  <div class="todo-list-container">
    <div
      class="todo-list-scroller"
      [ngClass]="showDone ? 'todos-todo-hidden' : showDone !== null ? 'todos-todo-shown' : ''"
    >
      <div class="todos">
        <div class="dated-section" *ngFor="let todolist of todos | keyvalue">
          <h3 class="date">{{ formatDate(todolist.key) }}</h3>
          <app-todo-item
            *ngFor="let todo of todolist.value; index as i"
            [class.hidden]="todo.done"
            [text]="todo.text"
            (check)="handleCheckboxCheck(todolist.key, i)"
            (editClick)="handleBeginEditing(todolist.key, i)"
          />
        </div>
      </div>
    </div>
    <div
      class="todo-list-scroller"
      [ngClass]="showDone === null ? 'hidden' : showDone ? 'todos-done-shown' : 'todos-done-hidden'"
    >
      <div class="todos">
        <div class="dated-section" *ngFor="let todolist of done | keyvalue">
          <h3 class="date">{{ formatDate(todolist.key) }}</h3>
          <app-todo-item
            *ngFor="let todo of todolist.value; index as i"
            [text]="todo"
            [done]="true"
          />
        </div>
      </div>
    </div>
  </div>

  <div class="btns-container" [class.hide-down]="showDone" [class.show-up]="showDone === false">
    <button class="create-btn" mat-flat-button color="primary" (click)="handleCreateClick()">
      Create
    </button>
    <button class="robo-btn" mat-flat-button color="accent" [disabled]="todoCount === doneCount">
      <mat-icon class="robo-icon" fontIcon="smart_toy" />
    </button>
  </div>

  <app-modal [shown]="modalShown" (onClose)="handleModalClose()" [hideX]="true">
    <div class="modal-content">
      <mat-form-field>
        <mat-label>Enter TODO</mat-label>
        <input
          placeholder="Your TODO..."
          [formControl]="modalText"
          matInput
          (input)="handleModalInput($event)"
          [value]="modalText.value"
          (keydown.enter)="handleSaveClick()"
          [cdkTrapFocusAutoCapture]="modalShown"
          [cdkTrapFocus]="modalShown"
          required
        />
      </mat-form-field>

      <button
        mat-flat-button
        color="accent"
        (click)="handleSaveClick()"
        [disabled]="modalText.invalid"
      >
        Save
      </button>
    </div>
  </app-modal>
</div>

<router-outlet></router-outlet>
